networks:
  traefik-proxy:
    external: true

services:
  omni-tools:
    image: iib0011/omni-tools:0.6.0
    container_name: omni-tools
    restart: unless-stopped
    healthcheck:
      test: 'curl --fail --insecure --location --silent --show-error http://localhost:80/'
      interval: 1m
      timeout: 10s
      retries: 5
      start_period: 15s
    networks:
      - traefik-proxy
    labels:
      traefik.enable: true
      traefik.docker.network: traefik-proxy
      traefik.http.routers.omni-tools.entrypoints: https
      traefik.http.routers.omni-tools.rule: Host(`omni-tools.${TRAEFIK_BASE_DOMAIN:?TRAEFIK_BASE_DOMAIN is not set}`)
      traefik.http.routers.omni-tools.tls: true
      traefik.http.routers.omni-tools.tls.certresolver: cloudflare
      traefik.http.routers.omni-tools.service: omni-tools
      traefik.http.services.omni-tools.loadbalancer.server.port: 80
      traefik.http.services.omni-tools.loadbalancer.healthcheck.path: /

      wud.tag.include: '^\d+\.\d+\.\d+$$'
      wud.link.template: 'https://github.com/iib0011/omni-tools/releases/tag/v$${major}.$${minor}.$${patch}'
